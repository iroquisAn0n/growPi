#!/bin/bash

main() {
	local now save_path

	now=$(date +"%Y-%m-%d_%H%M")
	save_path=/home/pi/Pictures/growing #todo: make sure this directory exists and is writable

	##CameraV3
	/usr/bin/libcamera-jpeg --width 1280 --height 1024 --hflip 1 --vflip 1 -n --hdr -o "${save_path}"/temp.jpg #todo: make params configurable

	./transmitPhoto "${save_path}"/temp.jpg

	#Rename last photo #todo: make persistence configurable
	/bin/mv "${save_path}"/temp.jpg "${save_path}"/"${now}".jpg
}

main "$@"
